# Amortized Community Detection 



This repo contains the PyTorch implementation of GCN-CCP.

<!-- a normal html comment  
- Ari Pakman*, Yueqi Wang*, Yoonho Lee, Pallab Basu, Juho Lee, Yee Whye Teh, Liam Paninski, [Attentive Clustering Processes](https://arxiv.org/abs/2010.15727), arXiv preprint 2020
- Ari Pakman, Yueqi Wang, Catalin Mitelut, JinHyung Lee, Liam Paninski, [Neural Clustering Processes](https://arxiv.org/abs/1901.00409), ICML 2020
-->

### Graph community detection using CCP + Graph ConvNets (GCN)

Here we use synthetic graphs generated by stochastic block models (SBM) as an example.
#### Training
```
cd amortized_community_detection

# GCN-CCP with GraphSAGE encoder
python -m acp.train_acp --model_name acp --data_type sbm_beta_crp --encoder_type graphsage

# GCN-CCP with GatedGCN encoder
python -m acp.train_acp --model_name acp --data_type sbm_beta_crp --encoder_type gatedgcn


```

#### Inference -- probablistic clustering
```
# Cluster SBM graphs using a saved checkpoint
python -m acp.inference.acp_cluster_sbm --data_type sbm_beta_crp --encoder_type graphsage \
  --model_file ./saved_models/xxxx.pt

```

### Other types of data

#### Mixture of Gaussian (MOG)
```
python -m acp.train_acp --model_name mog --data_type mog --encoder_type mog
```

